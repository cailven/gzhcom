<?xml version="1.0" encoding="utf-8"?>
<div id="code">
  <section id="整体" style="line-height: 0; pointer-events: none; overflow: hidden;visibility: visible;overflow:hidden;font-size: 0;">
    <section id="伸长" style="overflow:hidden">
      <section id="内容层" style="=">
        
        <svg style="pointer-events: none;transform: scale(1);display: inline-block;width: 100%;background-position: 0% 0%;background-repeat: no-repeat;background-size: 100%;
        background-image: url(&quot;images/20240628qingmei/1.gif&quot;);"
             viewBox="0 0 345 613.1800000000001">
          <g>
            <g transform="translate(1000 0)">
              <foreignObject x="0" y="0" width="100%" height="100%">
                <svg style="display: inline-block;width: 100%;background-position: 0% 0%;background-repeat: no-repeat;background-size:100%;
                        background-image: url(&quot;images/20240628qingmei/2.gif&quot;);"
                     viewBox="0 0 345 613.1800000000001">
                </svg>
              </foreignObject>
            </g>
            <g>
              <g transform="translate(2000 0)">
                <foreignObject x="0" y="0" width="100%" height="100%">
                  <svg style="display: inline-block;width: 100%;background-position: 0% 0%;background-repeat: no-repeat;background-size:100%;
                            background-image: url(&quot;images/20240628qingmei/3.gif&quot;);"
                       viewBox="0 0 345 613.1800000000001">
                  </svg>
                </foreignObject>
              </g>
              <g>
                <g transform="translate(3000 0)">
                  <foreignObject x="0" y="0" width="100%" height="100%">
                    <svg style="display: inline-block;width: 100%;background-position: 0% 0%;background-repeat: no-repeat;background-size:100%;
                        background-image: url(&quot;images/20240628qingmei/4.gif&quot;);"
                         viewBox="0 0 345 613.1800000000001">
                    </svg>
                  </foreignObject>
                </g>
                <g>
                  <foreignObject x="4000" y="0" width="100%" height="100%">
                    <svg style="display: inline-block;width: 100%;background-position: 0% 0%;background-repeat: no-repeat;background-size:100%;
                        background-image: url(&quot;images/20240628qingmei/5.gif&quot;);"
                         viewBox="0 0 345 613.1800000000001">
                    </svg>
                  </foreignObject>
                  <g>
                    <foreignObject x="5000" y="0" width="100%" height="100%">
                      <svg style="display: inline-block;width: 100%;background-position: 0% 0%;background-repeat: no-repeat;background-size:100%;
                        background-image: url(&quot;images/20240628qingmei/6.gif&quot;);"
                           viewBox="0 0 345 613.1800000000001">
                      </svg>
                    </foreignObject>

                    <rect style="pointer-events:auto;" x="4000" y="0" width="100%" height="100%" opacity="0">
                      <set attributeName="visibility" from="visible" to="hidden" begin="click"></set>
                    </rect>
                    <animateTransform attributeName="transform" type="translate" values="-1000 0" fill="freeze" begin="click" dur="1000s"></animateTransform>
                  </g>
                  <rect style="pointer-events:auto;" x="3000" y="0" width="100%" height="100%" opacity="0">
                    <set attributeName="visibility" from="visible" to="hidden" begin="click"></set>
                  </rect>
                  <animateTransform attributeName="transform" type="translate" values="-1000 0" fill="freeze" begin="click" dur="1000s"></animateTransform>
                </g>
                <rect style="pointer-events:auto;" x="2000" y="0" width="100%" height="100%" opacity="0">
                  <set attributeName="visibility" from="visible" to="hidden" begin="click"></set>
                </rect>
                <animateTransform attributeName="transform" type="translate" values="-1000 0" fill="freeze" begin="click" dur="1000s"></animateTransform>
              </g>
              <rect style="pointer-events:auto;" x="1000" y="0" width="100%" height="100%" opacity="0">
                <set attributeName="visibility" from="visible" to="hidden" begin="click"></set>
              </rect>
              <animateTransform attributeName="transform" type="translate" values="-1000 0" fill="freeze" begin="click" dur="1000s"></animateTransform>
            </g>
            <rect style="pointer-events:auto;" x="0" y="0" width="100%" height="100%" opacity="0">
              <set attributeName="visibility" from="visible" to="hidden" begin="click"></set>
            </rect>
            <animateTransform attributeName="transform" type="translate" values="-1000 0" fill="freeze" begin="click" dur="1000s"></animateTransform>
          </g>
        </svg>

      </section>
    </section>
  </section>
</div>
<form id ="J_Form" method="post" enctype="multipart/form-data" class="form-horizontal" action="#" onsubmit="return doCampaignEdit();">
  <input type="file" accept="image/png, image/gif, image/jpeg, image/jpg" name="file[]" id="file" multiple="multiple" />
  <input type="submit" name="submit" value="上传" />
</form>
<script src="js/jquery.js"></script>
<!--<script src="js/伸长计算.js"></script>-->
<script>
  var projectID = "20240628qingmei"
  var endTxt = null
  function doCampaignEdit() {
    var formData = new FormData($('#J_Form')[0]);
    console.log(formData)
    $.ajax({
      url: 'https://svgtools.im20.com.cn/User/doUploadWx',
      type: 'POST',
      dataType: 'json',
      data: formData,
      contentType: false,
      processData: false,
      success: function (data) {
        if(data.code==0){
          console.log(data)
          $('#code').each(function() {
            var oldText = $(this).html();
            if(endTxt){
              endTxt = endTxt;
            }else {
              endTxt = oldText;
            }
            for(let i=0;i<data.data.length;i++){
              // endTxt = endTxt.replace("images/"+projectID+"/"+data.data[i].name,data.data[i].upl_url);
              endTxt = replaceAll(endTxt, "images/"+projectID+"/"+data.data[i].name, data.data[i].upl_url);
            }
            console.log(endTxt)
          });
        }
      }
    });
    return false;
  }
  function replaceAll(str, charToReplace, charReplacement) {
    // 使用正则表达式创建一个全局搜索的字符串，以匹配所有出现的charToReplace
    const regex = new RegExp(charToReplace, 'g');
    // 使用replace方法进行替换
    return str.replace(regex, charReplacement);
  }
</script>